#include "script_component.hpp"

params [
	["_area", objNull, [objNull, []]],
	["_group", grpNull, [grpNull]]
];

waypoints _group

[{
	params [
		["_area", objNull, [objNull, []]],
		["_group", grpNull, [grpNull]]
	];
	private _idx = currentWaypoint _group;
 	private _wps = waypoints _group;
	private _maxIdx = (count _wps) - 1;
	if (_idx > _maxIdx) exitWith {
		diag_log "all waypoints completed";
	};
	if (_idx == 0) exitWith {
		diag_log "no wps at this time";
	};

	// check if wp is in forbidden area
	private _wpPos = waypointPosition [_group, _idx];
	if (_wpPos inArea _area) then {
		// TODO

		// if group pos in area: get outside by quickest route
		// else: stop at border
		diag_log "changing wp!";
		private _newPos = [0, 0, 0];

		[_grp, _idx] setWaypointPosition [_newPos, 15];
	};

}, 5, [_area, _group]] call CBA_fnc_addPerFrameHandler;
